{"source":2,"revision":8,"description":null,"createdBy":{"displayName":"Rick Taylor","url":"https://spsprodcus3.vssps.visualstudio.com/A3d79a496-d038-417c-ac97-459c444774e8/_apis/Identities/8aa6832b-9071-479c-9b61-2d21e682cc46","_links":{"avatar":{"href":"https://dev.azure.com/slickrickistheman0443/_apis/GraphProfile/MemberAvatars/msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm"}},"id":"8aa6832b-9071-479c-9b61-2d21e682cc46","uniqueName":"slickrickistheman@hotmail.com","imageUrl":"https://dev.azure.com/slickrickistheman0443/_apis/GraphProfile/MemberAvatars/msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm","descriptor":"msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm"},"createdOn":"2023-06-10T06:22:50.247Z","modifiedBy":{"displayName":"Rick Taylor","url":"https://spsprodcus3.vssps.visualstudio.com/A3d79a496-d038-417c-ac97-459c444774e8/_apis/Identities/8aa6832b-9071-479c-9b61-2d21e682cc46","_links":{"avatar":{"href":"https://dev.azure.com/slickrickistheman0443/_apis/GraphProfile/MemberAvatars/msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm"}},"id":"8aa6832b-9071-479c-9b61-2d21e682cc46","uniqueName":"slickrickistheman@hotmail.com","imageUrl":"https://dev.azure.com/slickrickistheman0443/_apis/GraphProfile/MemberAvatars/msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm","descriptor":"msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm"},"modifiedOn":"2023-06-14T15:20:36.800Z","isDeleted":false,"lastRelease":{"id":4,"name":"Release-4","artifacts":[],"_links":{},"description":"","releaseDefinition":{"id":1,"projectReference":null,"_links":{}},"createdOn":"2023-06-14T15:28:59.950Z","createdBy":{"displayName":"Rick Taylor","url":"https://spsprodcus3.vssps.visualstudio.com/A3d79a496-d038-417c-ac97-459c444774e8/_apis/Identities/8aa6832b-9071-479c-9b61-2d21e682cc46","_links":{"avatar":{"href":"https://dev.azure.com/slickrickistheman0443/_apis/GraphProfile/MemberAvatars/msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm"}},"id":"8aa6832b-9071-479c-9b61-2d21e682cc46","uniqueName":"slickrickistheman@hotmail.com","imageUrl":"https://dev.azure.com/slickrickistheman0443/_apis/GraphProfile/MemberAvatars/msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm","descriptor":"msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm"}},"variables":{"appservicename":{"value":"pulterraformweba111effb"},"appserviceplan":{"value":"PULTerraformplan"},"storagekey":{"value":"PipelineWillGetThisValueRuntime"},"terraformstorageaccount":{"value":"terraformstoragea111effb"},"terraformstoragerg":{"value":"terraformrg"}},"variableGroups":[],"environments":[{"id":1,"name":"Dev","rank":1,"owner":{"displayName":"Rick Taylor","url":"https://spsprodcus3.vssps.visualstudio.com/A3d79a496-d038-417c-ac97-459c444774e8/_apis/Identities/8aa6832b-9071-479c-9b61-2d21e682cc46","_links":{"avatar":{"href":"https://dev.azure.com/slickrickistheman0443/_apis/GraphProfile/MemberAvatars/msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm"}},"id":"8aa6832b-9071-479c-9b61-2d21e682cc46","uniqueName":"slickrickistheman@hotmail.com","imageUrl":"https://dev.azure.com/slickrickistheman0443/_apis/GraphProfile/MemberAvatars/msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm","descriptor":"msa.ZTExNGU4MGItM2I0Mi03ZjhhLWJiNjgtM2YyMTVjZTA4MTFm"},"variables":{},"variableGroups":[],"preDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":1}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":1}},"deployStep":{"id":2},"postDeployApprovals":{"approvals":[{"rank":1,"isAutomated":true,"isNotificationOn":false,"id":3}],"approvalOptions":{"requiredApproverCount":null,"releaseCreatorCanBeApprover":false,"autoTriggeredAndPreviousEnvironmentApprovedCanBeSkipped":false,"enforceIdentityRevalidation":false,"timeoutInMinutes":0,"executionOrder":2}},"deployPhases":[{"deploymentInput":{"parallelExecution":{"parallelExecutionType":0},"agentSpecification":{"identifier":"windows-2019"},"skipArtifactsDownload":false,"artifactsDownloadInput":{"downloadInputs":[]},"queueId":72,"demands":[],"enableAccessToken":false,"timeoutInMinutes":0,"jobCancelTimeoutInMinutes":1,"condition":"succeeded()","overrideInputs":{}},"rank":1,"phaseType":1,"name":"Agent job","refName":null,"workflowTasks":[{"environment":{},"taskId":"46e4be58-730b-4389-8a2f-ea10b3e5e815","version":"1.*","name":"Azure CLI to deploy required Azure resources","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"connectedServiceNameARM":"9ffa8fbb-51d0-47a2-8628-83d9be06e932","scriptLocation":"inlineScript","scriptPath":"","inlineScript":"# this will create Azure resource group\ncall az group create --location westus --name $(terraformstoragerg)\n\ncall az storage account create --name $(terraformstorageaccount) --resource-group $(terraformstoragerg) --location westus --sku Standard_LRS\n\ncall az storage container create --name terraform --account-name $(terraformstorageaccount)\n\ncall az storage account keys list -g $(terraformstoragerg) -n $(terraformstorageaccount)\n\n","args":"","addSpnToEnvironment":"false","useGlobalConfig":"false","cwd":"","failOnStandardError":"false"}},{"environment":{},"taskId":"72a1931b-effb-4d2e-8fd8-f8472a07cb62","version":"3.*","name":"Azure PowerShell script to get the storage key","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"ConnectedServiceNameSelector":"ConnectedServiceNameARM","ConnectedServiceName":"","ConnectedServiceNameARM":"9ffa8fbb-51d0-47a2-8628-83d9be06e932","ScriptType":"InlineScript","ScriptPath":"","Inline":"# Using this script we will fetch storage key which is required in terraform file to authenticate backend storage account\n\n$key=(Get-AzureRmStorageAccountKey -ResourceGroupName $(terraformstoragerg) -AccountName $(terraformstorageaccount)).Value[0]\n\nWrite-Host \"##vso[task.setvariable variable=storagekey]$key\"","ScriptArguments":"","errorActionPreference":"stop","FailOnStandardError":"false","TargetAzurePs":"LatestVersion","CustomTargetAzurePs":"","validateScriptSignature":"false"}},{"environment":{},"taskId":"a8515ec8-7254-4ffd-912c-86772e2b5962","version":"5.*","name":"Replace tokens in terraform file","refName":"","enabled":false,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"rootDirectory":"","targetFiles":"**/*.tf","encoding":"auto","tokenPattern":"custom","tokenPrefix":"__","tokenSuffix":"__","writeBOM":"true","escapeType":"none","escapeChar":"","charsToEscape":"","verbosity":"normal","actionOnMissing":"warn","keepToken":"false","actionOnNoFiles":"continue","enableTransforms":"false","transformPrefix":"(","transformSuffix":")","variableFiles":"","inlineVariables":"","variableSeparator":".","enableRecursion":"false","useLegacyPattern":"false","useLegacyEmptyFeature":"true","useDefaultValue":"false","emptyValue":"(empty)","defaultValue":"","enableTelemetry":"true"}},{"environment":{},"taskId":"a4789e5d-f6e8-431f-add9-379d640a883c","version":"1.*","name":"Install Terraform latest","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"terraformVersion":"latest"}},{"environment":{},"taskId":"fe504acc-6115-40cb-89ff-191386b5e7bf","version":"2.*","name":"Terraform : init","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"provider":"azurerm","command":"init","workingDirectory":"$(System.DefaultWorkingDirectory)/_Terraform/src","commandOptions":"","environmentServiceNameAzureRM":"","environmentServiceNameAWS":"","environmentServiceNameGCP":"","backendServiceArm":"9ffa8fbb-51d0-47a2-8628-83d9be06e932","backendAzureRmResourceGroupName":"$(terraformstoragerg)","backendAzureRmStorageAccountName":"$(terraformstorageaccount) ","backendAzureRmContainerName":"tfstate","backendAzureRmKey":"terraform.tfstate","backendServiceAWS":"","backendAWSBucketName":"","backendAWSKey":"","backendServiceGCP":"","backendGCPBucketName":"","backendGCPPrefix":""}},{"environment":{},"taskId":"fe504acc-6115-40cb-89ff-191386b5e7bf","version":"2.*","name":"Terraform : plan","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"provider":"azurerm","command":"plan","workingDirectory":"$(System.DefaultWorkingDirectory)/_Terraform/src","commandOptions":"","environmentServiceNameAzureRM":"9ffa8fbb-51d0-47a2-8628-83d9be06e932","environmentServiceNameAWS":"","environmentServiceNameGCP":"","backendServiceArm":"","backendAzureRmResourceGroupName":"$(terraformstoragerg)","backendAzureRmStorageAccountName":"$(terraformstorageaccount) ","backendAzureRmContainerName":"terraform","backendAzureRmKey":"$(storagekey)","backendServiceAWS":"","backendAWSBucketName":"","backendAWSKey":"","backendServiceGCP":"","backendGCPBucketName":"","backendGCPPrefix":""}},{"environment":{},"taskId":"fe504acc-6115-40cb-89ff-191386b5e7bf","version":"2.*","name":"Terraform : apply -auto-approve","refName":"","enabled":true,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"provider":"azurerm","command":"apply","workingDirectory":"$(System.DefaultWorkingDirectory)/_Terraform/src","commandOptions":"-auto-approve","environmentServiceNameAzureRM":"9ffa8fbb-51d0-47a2-8628-83d9be06e932","environmentServiceNameAWS":"","environmentServiceNameGCP":"","backendServiceArm":"","backendAzureRmResourceGroupName":"$(terraformstoragerg)","backendAzureRmStorageAccountName":"$(terraformstorageaccount) ","backendAzureRmContainerName":"terraform","backendAzureRmKey":"$(storagekey)","backendServiceAWS":"","backendAWSBucketName":"","backendAWSKey":"","backendServiceGCP":"","backendGCPBucketName":"","backendGCPPrefix":""}},{"environment":{},"taskId":"497d490f-eea7-4f2b-ab94-48d9c1acdcb1","version":"3.*","name":"Azure App Service Deploy: $(appservicename)","refName":"","enabled":false,"alwaysRun":false,"continueOnError":false,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"definitionType":"task","overrideInputs":{},"condition":"succeeded()","inputs":{"ConnectedServiceName":"9ffa8fbb-51d0-47a2-8628-83d9be06e932","WebAppKind":"app","WebAppName":"$(appservicename)","DeployToSlotFlag":"false","ResourceGroupName":"","SlotName":"","ImageSource":"Registry","AzureContainerRegistry":"","AzureContainerRegistryLoginServer":"","AzureContainerRegistryImage":"","AzureContainerRegistryTag":"","DockerRepositoryAccess":"public","RegistryConnectedServiceName":"","PrivateRegistryImage":"","PrivateRegistryTag":"","DockerNamespace":"","DockerRepository":"","DockerImageTag":"","VirtualApplication":"","Package":"$(System.DefaultWorkingDirectory)/**/*.zip","BuiltinLinuxPackage":"$(System.DefaultWorkingDirectory)/**/*.zip","RuntimeStack":"","StartupCommand":"","WebAppUri":"","ScriptType":"","InlineScript":":: You can provide your deployment commands here. One command per line.","ScriptPath":"","GenerateWebConfig":"false","WebConfigParameters":"","AppSettings":"","ConfigurationSettings":"","TakeAppOfflineFlag":"false","UseWebDeploy":"false","SetParametersFile":"","RemoveAdditionalFilesFlag":"false","ExcludeFilesFromAppDataFlag":"false","AdditionalArguments":"","RenameFilesFlag":"false","XmlTransformation":"false","XmlVariableSubstitution":"false","JSONFiles":""}}]}],"environmentOptions":{"emailNotificationType":"OnlyOnFailure","emailRecipients":"release.environment.owner;release.creator","skipArtifactsDownload":false,"timeoutInMinutes":0,"enableAccessToken":false,"publishDeploymentStatus":true,"badgeEnabled":false,"autoLinkWorkItems":false,"pullRequestDeploymentEnabled":false},"demands":[],"conditions":[{"name":"ReleaseStarted","conditionType":1,"value":""}],"executionPolicy":{"concurrencyCount":1,"queueDepthCount":0},"schedules":[],"currentRelease":{"id":4,"url":"https://vsrm.dev.azure.com/slickrickistheman0443/95e099d2-b333-47c2-b8c5-7e5f134e72e0/_apis/Release/releases/4","_links":{}},"retentionPolicy":{"daysToKeep":30,"releasesToKeep":3,"retainBuild":true},"processParameters":{},"properties":{"LinkBoardsWorkItems":{"$type":"System.String","$value":"False"}},"preDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"postDeploymentGates":{"id":0,"gatesOptions":null,"gates":[]},"environmentTriggers":[],"badgeUrl":"https://vsrm.dev.azure.com/slickrickistheman0443/_apis/public/Release/badge/95e099d2-b333-47c2-b8c5-7e5f134e72e0/1/1"}],"artifacts":[{"sourceId":"95e099d2-b333-47c2-b8c5-7e5f134e72e0:70f0b3d7-9c22-4ded-a700-1b6ab8cbf15d","type":"Git","alias":"_Terraform","definitionReference":{"branches":{"id":"master","name":"master"},"checkoutNestedSubmodules":{"id":"True","name":"Any nested submodules within"},"checkoutSubmodules":{"id":"","name":""},"defaultVersionSpecific":{"id":"","name":""},"defaultVersionType":{"id":"latestFromBranchType","name":"Latest from the default branch"},"definition":{"id":"70f0b3d7-9c22-4ded-a700-1b6ab8cbf15d","name":"Terraform"},"fetchDepth":{"id":"","name":""},"gitLfsSupport":{"id":"","name":""},"project":{"id":"95e099d2-b333-47c2-b8c5-7e5f134e72e0","name":"Terraform Demo"}},"isPrimary":true,"isRetained":false}],"triggers":[],"releaseNameFormat":"Release-$(rev:r)","tags":[],"properties":{"DefinitionCreationSource":{"$type":"System.String","$value":"ReleaseClone"},"IntegrateJiraWorkItems":{"$type":"System.String","$value":"false"},"IntegrateBoardsWorkItems":{"$type":"System.String","$value":"False"}},"id":1,"name":"Terraform-CD","path":"\\","projectReference":null,"url":"https://vsrm.dev.azure.com/slickrickistheman0443/95e099d2-b333-47c2-b8c5-7e5f134e72e0/_apis/Release/definitions/1","_links":{"self":{"href":"https://vsrm.dev.azure.com/slickrickistheman0443/95e099d2-b333-47c2-b8c5-7e5f134e72e0/_apis/Release/definitions/1"},"web":{"href":"https://dev.azure.com/slickrickistheman0443/95e099d2-b333-47c2-b8c5-7e5f134e72e0/_release?definitionId=1"}}}